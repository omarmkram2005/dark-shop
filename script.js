let all_items = {
  id001: {
    name: "Basic Sandals",
    price: 20.0,
    img: "assets/shop/imgs/images01 (1).jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Shoes",
    sali: false,
    sailAmount: 5,
  },
  id002: {
    name: "Beautiful Hat",
    price: 15.0,
    img: "assets/home/imgs/images05.jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Hat",
    sali: false,
    sailAmount: 5,
  },
  id003: {
    name: "Beige Shorts",
    price: 35.0,
    img: "assets/home/imgs/images11 (1).jpg",
    rate: 3,

    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Clothing",
    sali: false,
    sailAmount: 5,
  },
  id004: {
    name: "Brown Backpack",
    price: 15.0,
    img: "assets/home/imgs/images09.jpg",
    rate: 5,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Backpacks",
    sali: false,
    sailAmount: 5,
  },
  id005: {
    name: "Brown Shoes",
    price: 15.0,
    img: "assets/home/imgs/images08.jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Shoes",
    sali: false,
    sailAmount: 5,
  },
  id006: {
    name: "Color Bag",
    price: 35.0,
    img: "assets/shop/imgs/color.jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Bags",
    sali: false,
    sailAmount: 5,
  },
  id007: {
    name: "Cool Glasses",
    price: 18.0,
    img: "assets/shop/imgs/images06 (2).jpg",
    rate: 5,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Sunglasses",
    sali: true,
    sailAmount: 5,
  },
  id008: {
    name: "Cool Hat",
    price: 12.0,
    img: "assets/shop/imgs/images07 (2).jpg",
    rate: 5,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Hat",
    sali: false,
    sailAmount: 5,
  },
  id009: {
    name: "Fancy Bag",
    price: 35.0,
    img: "assets/home/imgs/images10.jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Clothing",
    sali: false,
    sailAmount: 5,
  },
  id010: {
    name: "Fancy Shoes",
    price: 35.0,
    img: "assets/shop/imgs/images08 (1).jpg",
    rate: 3,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Shoes",
    sali: false,
    sailAmount: 5,
  },
  id011: {
    name: "Jeans Shorts",
    price: 20.0,
    img: "assets/shop/imgs/images09.jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Clothing",
    sali: false,
    sailAmount: 5,
  },
  id012: {
    name: "Light Shoes",
    price: 18.0,
    img: "assets/shop/imgs/images10.jpg",
    rate: 4,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Shoes",
    sali: false,
    sailAmount: 5,
  },
  id013: {
    name: "Lily Shirt",
    price: 20.0,
    img: "assets/shop/imgs/lily.jpg",
    rate: 5,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Clothing",
    sali: false,
    sailAmount: 5,
  },
  id014: {
    name: "White Bag",
    price: 35.0,
    img: "assets/shop/imgs/images13.jpg",
    rate: 5,
    description:
      "Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.",
    catagory: "Bags",
    sali: false,
    sailAmount: 5,
  },
};

for (const key in all_items) {
  if (all_items[key].sali == true) {
    all_items[key].price = all_items[key].price - all_items[key].sailAmount;
  }
}

// create all the elements needed
let searchBar = document.createElement("input");
let searchRes = document.createElement("div");
let searchBg = document.createElement("div");
let searchBgDiv = document.createElement("div");
let closeIcon = document.createElement("i");

// give ides and classes
searchBgDiv.id = "searchBgDiv";
closeIcon.id = "closeIcon";
searchBar.id = "search-bar";
searchRes.id = "searchRes";
searchBar.type = "search";
searchBg.id = "searchBg";

searchRes.style = `
          max-height: 40vh;
          height: fit-content;
          overflow: scroll;
          position: fixed;
          top: calc(50% + 6vh);
          left: 50%;
          transform: translateX(-50%);
          width: 70vw;


`;

searchBgDiv.innerHTML = `
<svg
  class="fill-slate-200 ml-2 pr-1"
  id="searchIcon"
  onclick="searchPros()"
  width="64px"
  height="41px"
  clip-rule="evenodd"
  fill-rule="evenodd"
  stroke-linejoin="round"
  stroke-miterlimit="2"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg">
  <path
    d="m15.97 17.031c-1.479 1.238-3.384 1.985-5.461 1.985-4.697 0-8.509-3.812-8.509-8.508s3.812-8.508 8.509-8.508c4.695 0 8.508 3.812 8.508 8.508 0 2.078-.747 3.984-1.985 5.461l4.749 4.75c.146.146.219.338.219.531 0 .587-.537.75-.75.75-.192 0-.384-.073-.531-.22zm-5.461-13.53c-3.868 0-7.007 3.14-7.007 7.007s3.139 7.007 7.007 7.007c3.866 0 7.007-3.14 7.007-7.007s-3.141-7.007-7.007-7.007z"
    fill-rule="nonzero" />
</svg>
`;
closeIcon.classList.add("fa-solid", "fa-x");
searchBar.placeholder = "Search...";

// add all to the body
searchBgDiv.appendChild(searchBar);
searchBgDiv.appendChild(searchRes);
searchBgDiv.appendChild(closeIcon);
document.body.appendChild(searchBgDiv);
document.body.appendChild(searchBg);
let searchIcon = document.getElementById("searchIcon");

// animations and Functionality

// to make search section appear with animations
function searchPros() {
  searchBg.style.display = "block";
  searchBgDiv.style.display = "block";
  searchBar.style.display = "block";
  searchIcon.style.display = "block";
  closeIcon.style.display = "block";
  setTimeout(() => {
    searchBar.style.top = "50%";
    searchIcon.style.top = "47vh";
    searchBg.style.opacity = "0.7";
    searchBgDiv.style.opacity = "1";
    searchBar.style.opacity = "1";
    searchIcon.style.opacity = "1";
    closeIcon.style.opacity = "1";
  }, 50);

  // add close events
  searchBg.onclick = closeSearch;
  closeIcon.onclick = closeSearch;

  // to make search section disappear with animations
  function closeSearch() {
    searchBg.style.opacity = "0";
    searchBgDiv.style.opacity = "0";
    searchBar.style.opacity = "0";
    searchIcon.style.opacity = "0";
    closeIcon.style.opacity = "0";
    searchBar.style.top = "65%";
    searchIcon.style.top = "62vh";
    setTimeout(() => {
      searchBg.style.display = "none";
      searchBgDiv.style.display = "none";
      searchIcon.style.display = "none";
      searchBar.style.display = "none";
      closeIcon.style.display = "none";
    }, 500);
  }
}
// get all elements needed
let list_home = document.getElementById("list_home");
let list_shop = document.getElementById("list_shop");
let listHome = document.getElementById("list-home");
let listShop = document.getElementById("list-shop");

let disappear;

// hover effect
list_home.addEventListener("mouseleave", function (params) {
  listHome.style.opacity = "0";
  disappear = setTimeout(() => {
    listHome.style.display = "none";
  }, 710);
});
list_home.addEventListener("mouseover", function (params) {
  listHome.style.display = "block";
  clearTimeout(disappear);
  setTimeout(() => {
    listHome.style.opacity = "1";
  }, 10);
});
let disappear2;
list_shop.addEventListener("mouseleave", function (params) {
  listShop.style.opacity = "0";
  disappear2 = setTimeout(() => {
    listShop.style.display = "none";
  }, 710);
});
list_shop.addEventListener("mouseover", function (params) {
  listShop.style.display = "block";
  clearTimeout(disappear2);
  setTimeout(() => {
    listShop.style.opacity = "1";
  }, 10);
});

// get all elements needed
let mobileNavState = false;
let nav = document.getElementById("mobile-nav");
let openMenu = document.getElementById("open-menu");
let closeMenu = document.getElementById("close-menu");
let homeItem = document.getElementById("homeItem");
let spanHome = document.getElementById("spanHome");
let arrow1 = document.getElementById("arrow1");
let shopItem = document.getElementById("shopItem");
let spanShop = document.getElementById("spanShop");
let arrow2 = document.getElementById("arrow2");
let list1 = document.getElementById("list1");
let list2 = document.getElementById("list2");
let arrow1Status = false;
let arrow2Status = false;
// make the animations and make mobile menu appear and disappear whin needed
function mobileMenu() {
  if (mobileNavState === false) {
    mobileNavState = true;
    openMenu.style.transform = ` rotatex(90deg) `;

    closeMenu.style.transform = ` rotatex(0deg)`;

    nav.style.height = "250px";
  } else {
    mobileNavState = false;
    closeMenu.style.transform = ` rotatex(90deg) `;

    openMenu.style.transform = ` rotatex(0deg) `;
    arrow1Status = false;
    arrow1.style.transform = "rotate(0deg)";
    arrow2.style.transform = "rotate(0deg)";
    arrow2Status = false;
    list1.style.height = "0px";
    list2.style.height = "0px";
    nav.style.height = "0px";
  }
}
// handle side slider  animations
function mobileMenuSideSlider() {
  nav.style.height = "fit-content";
  if (
    event.target == homeItem ||
    event.target == arrow1 ||
    event.target == spanHome
  ) {
    if (arrow1Status === false) {
      arrow1Status = true;
      arrow1.style.transform = "rotate(90deg)";
      list1.style.height = "130.5px";
    } else {
      arrow1Status = false;
      arrow1.style.transform = "rotate(0deg)";
      list1.style.height = "0px";
    }
  } else if (
    event.target == shopItem ||
    event.target == arrow2 ||
    event.target == spanShop
  ) {
    if (arrow2Status == false) {
      arrow2Status = true;
      arrow2.style.transform = "rotate(90deg)";
      list2.style.height = "130.5px";
    } else {
      arrow2Status = false;
      arrow2.style.transform = "rotate(0deg)";
      list2.style.height = "0px";
    }
  }
  setTimeout(() => {
    nav.style.height = `${nav.offsetHeight}px`;
  }, 700);
}

let spanCont = document.getElementById("over");
let spanBall = document.getElementById("spanBall");

setInterval(() => {
  setTimeout(() => {
    spanBall.style = `
    opacity:1;
    `;
  }, 500);
  setTimeout(() => {
    spanBall.style = `
    transform: translateY(26px);
    `;
  }, 1000);
  setTimeout(() => {
    spanBall.style = `
    transform: translateY(0px);
    opacity:0;

    `;
  }, 1500);
}, 2000);

spanCont.onclick = function (params) {
  window.scroll(0, 890);
};

let boxes = document.querySelectorAll(".box");

boxes.forEach((box) => {
  box.addEventListener("mouseover", (event) => {
    let view = event.currentTarget.querySelector(".view");
    let add = event.currentTarget.querySelector(".add");
    view.classList.remove("view-off");
    view.classList.add("view-on");
    add.classList.remove("off");
    add.classList.add("on");
  });
  box.addEventListener("mouseout", (event) => {
    let view = event.currentTarget.querySelector(".view");
    let add = event.currentTarget.querySelector(".add");
    view.classList.remove("view-on");
    view.classList.add("view-off");
    add.classList.remove("on");
    add.classList.add("off");
  });

  box.addEventListener("click", (event) => {
    let add = event.currentTarget.querySelector(".add");
    if (event.target == add) {
      let itemId = add.id;
      addToStorage(itemId);
      add.innerHTML = `
      <span class="cursor-pointer">
      <svg
      class="absolute left-[-30px] bottom-0 text-slate-100 text-[8px] pr-1 fill-slate-100"
      id="cart"
        width="30"
        height="24"
        clip-rule="evenodd"
        fill-rule="evenodd"
        stroke-linejoin="round"
        stroke-miterlimit="2"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg">
        <path
          d="m9.831 16.198.002-.003-1.113-.996-.004.004-2.468-2.202c-.144-.128-.322-.191-.5-.191-.417 0-.749.337-.749.75 0 .206.084.412.249.56l2.478 2.21-.767.873-4.71-4.202c-.144-.128-.322-.191-.5-.191-.416 0-.749.337-.749.75 0 .206.084.412.25.56l5.268 4.7c.143.128.321.191.499.191.206 0 .41-.084.559-.25l1.264-1.437 1.677 1.496c.143.128.321.191.499.191.206 0 .409-.084.558-.25l11.234-12.499c.129-.143.192-.322.192-.501 0-.419-.338-.75-.748-.75-.206 0-.411.084-.559.249l-10.735 11.943zm-.451-1.75 1.114.996 8.316-9.182c.128-.143.191-.322.191-.501 0-.419-.337-.75-.748-.75-.206 0-.411.084-.559.249z"
          fill-rule="nonzero" />
      </svg>      </span>add to cart</span>

    `;
      setTimeout(() => {
        add.innerHTML = `
      <span class="cursor-pointer">
      <svg
      class="absolute left-[-30px] bottom-0 text-slate-100 text-[8px] pr-1 fill-slate-100"
      id="cart"
      xmlns="http://www.w3.org/2000/svg"
      width="30"
      height="30"
      viewBox="0 0 24 24">
      <path
        d="M12.5 22h-9.5v-14h3v1.5c0 .276.224.5.5.5s.5-.224.5-.5v-1.5h6v1.5c0 .276.224.5.5.5s.5-.224.5-.5v-1.5h3v5.181c.482-.114.982-.181 1.5-.181l.5.025v-7.025h-5v-2c0-2.209-1.791-4-4-4s-4 1.791-4 4v2h-5v18h12.816c-.553-.576-1.004-1.251-1.316-2zm-5.5-18c0-1.654 1.346-3 3-3s3 1.346 3 3v2h-6v-2zm11.5 11c-2.484 0-4.5 2.015-4.5 4.5s2.016 4.5 4.5 4.5c2.482 0 4.5-2.015 4.5-4.5s-2.018-4.5-4.5-4.5zm2.5 5h-2v2h-1v-2h-2v-1h2v-2h1v2h2v1z" />
    </svg>
      </span>add to cart</span>

      `;
      }, 2000);
    }
  });
});
function addButtons() {
  let cart = document.getElementById("cart-menu");
  cart.innerHTML = `
       <li class="text-[#cccccc]">
        <div class="flex justify-between mt-2 mb-7">
          <span>Subtotal:</span>
          <span class="text-white"
            ><span>£</span><span id="subtotal">0.00</span></span
          >
        </div>
        <div class="flex justify-around gap-2">
          <button
            class="py-[7px] px-[15px] bg-slate-200 text-black rounded-md">
            <a href ="#" >View Cart</a>
          </button>
          <button
            class="py-[7px] px-[15px] bg-[#3ea8e6] text-white rounded-md">
            
            <a href ="#">Checkout</a>

          </button>
        </div>
      </li>
  `;
}

let allItemsPrices = [];

function addItemFirstTime(itemId, count = 1) {
  let cart = document.getElementById("cart-menu");
  let li = document.createElement("li");
  li.classList.add("flex", "pb-4", "pt-4", "relative");
  li.id = itemId;
  li.setAttribute("data-id", itemId);
  li.innerHTML = `
  <img
  class="w-[45px] rounded-sm cursor-pointer"
  src="${all_items[itemId].img}"
  alt="" />

  <div
  class="text-white pl-3 content flex justify-center flex-col">

  <p
  class="mb-2 text-[15px] transition-all duration-300 hover:text-sky-400 cursor-pointer text-[#cccccc]">
  ${all_items[itemId].name}
  </p>

  <span class="text-[#a8a8a8] text-[5px]"
  ><span id="count" >${count}</span> x £<span id="price">${all_items[
    itemId
  ].price.toFixed(2)}</span></span>
  <div class="mb-2 w-fit  right-0 top-2/4 absolute cursor-pointer" id="dele" onclick="deleCart()" ><svg class=" fill-[#bd0000]" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M19 24h-14c-1.104 0-2-.896-2-2v-16h18v16c0 1.104-.896 2-2 2zm-7-10.414l3.293-3.293 1.414 1.414-3.293 3.293 3.293 3.293-1.414 1.414-3.293-3.293-3.293 3.293-1.414-1.414 3.293-3.293-3.293-3.293 1.414-1.414 3.293 3.293zm10-8.586h-20v-2h6v-1.5c0-.827.673-1.5 1.5-1.5h5c.825 0 1.5.671 1.5 1.5v1.5h6v2zm-8-3h-4v1h4v-1z"/></svg></div>
  </div>
  `;
  cart.prepend(li);
  li.addEventListener("click", () => {
    const productId = li.getAttribute("data-id");

    const productDetailsUrl = `assets/shop/shop one item/shop one item.html?id=${productId}`;

    window.location.href = productDetailsUrl;
  });
}

let dele = document.getElementById("dele");
function deleCart() {
  let eventTarget = event.currentTarget;
  let eventTargetParent = eventTarget.parentElement;
  let main = eventTargetParent.parentElement;
  let price = Number(eventTargetParent.querySelector("#price").innerText);
  let count = Number(eventTargetParent.querySelector("#count").innerText);
  let total = price * count;
  let oldTotal = document.getElementById("subtotal");
  let newTotal = Number(oldTotal.innerText) - total;
  let preCookies = window.localStorage.getItem("inCart");
  let show = document.getElementById("show-amount");
  let showBg = document.getElementById("amountBg");

  let afrerCookies = preCookies.replace("," + main.id + "-" + count + ",", "");
  window.localStorage.setItem("inCart", afrerCookies);
  oldTotal.innerText = newTotal;

  show.innerText = Number(show.innerText) - Number(count);
  if (allItemsPrices.includes(price)) {
    for (let i = 0; i < count; i++) {
      allItemsPrices.splice(allItemsPrices.indexOf(price), 1);
    }
  }
  if (window.localStorage.getItem("inCart") == "") {
    window.localStorage.removeItem("inCart");
    document.getElementById("cart-menu").innerHTML = `
    <p class="text-xs text-neutral-500 z-10">There is no Items in The Cart</p>
    `;
    showBg.classList.add("hidden");
  }
  main.remove();
}

function addOneToItemCount(newValue, itemId) {
  let parent = document.getElementById(itemId);
  let count = parent.querySelector(`#count`);

  count.innerText = newValue;
}
function getSubTotal(itemId, number = 1) {
  let price = all_items[itemId].price * number;
  allItemsPrices.push(price);
  let sum = allItemsPrices.reduce(
    (accumulator, currentValue) => accumulator + currentValue,
    0
  );
  let subtotal = document.getElementById("subtotal");
  subtotal.innerText = sum;

  let showAmount = document.getElementById("show-amount");
  let amountBg = document.getElementById("amountBg");
  showAmount.innerText = Number(showAmount.innerText) + Number(number);
  if (amountBg.classList.contains("hidden")) {
    amountBg.classList.remove("hidden");
  }
}

function updateSupTotal() {}
function addToStorage(itemId) {
  if (window.localStorage.getItem("inCart")) {
    if (window.localStorage.getItem("inCart").includes(itemId)) {
      let str = window.localStorage.getItem("inCart");
      let targetId = itemId;

      let regex = new RegExp(`${targetId}-(\\d+)`);
      let match = str.match(regex);

      if (match) {
        let currentValue = match[1];
        let newValue = Number(currentValue) + 1;

        str = str.replace(
          `${targetId}-${currentValue}`,
          `${targetId}-${newValue}`
        );
        window.localStorage.setItem("inCart", str);
        addOneToItemCount(newValue, itemId);
        getSubTotal(itemId);
      }
    } else {
      window.localStorage.setItem(
        "inCart",
        window.localStorage.getItem("inCart") + "," + itemId + "-1,"
      );
      addItemFirstTime(itemId);
      getSubTotal(itemId);
    }
  } else {
    addButtons();
    window.localStorage.setItem("inCart", "," + itemId + "-1,");
    addItemFirstTime(itemId);
    getSubTotal(itemId);
  }
}
let disappearLogo;
let cart = document.getElementById("cart_handler");
let cartmenu = document.getElementById("cart-menu");
// hover effect
cart.addEventListener("mouseleave", function (params) {
  cartmenu.style.opacity = "0";
  disappearLogo = setTimeout(() => {
    cartmenu.style.display = "none";
  }, 710);
});
cart.addEventListener("mouseover", function (params) {
  clearTimeout(disappearLogo);
  cartmenu.style.display = "block";
  setTimeout(() => {
    cartmenu.style.opacity = "1";
  }, 10);
});
function throttle(func, limit) {
  let lastFunc;
  let lastRan;

  return function (...args) {
    const context = this;

    if (!lastRan) {
      func.apply(context, args);
      lastRan = Date.now();
    } else {
      clearTimeout(lastFunc);
      lastFunc = setTimeout(() => {
        if (Date.now() - lastRan >= limit) {
          func.apply(context, args);
          lastRan = Date.now();
        }
      }, limit - (Date.now() - lastRan));
    }
  };
}
let jump = document.querySelector(".jump");
function onScroll() {
  if (window.scrollY >= 300) {
    jump.style.opacity = "1";
  } else {
    jump.style.opacity = "0";
  }
}
window.addEventListener("scroll", throttle(onScroll, 500));
jump.onclick = function () {
  window.scrollTo({ top: 0 });
};
document.querySelectorAll(".image").forEach((element) => {
  if (
    element.parentElement.className.includes("box") ||
    element.parentElement.className.includes("row")
  ) {
    element.addEventListener("click", () => {
      goToProLink(element);
    });
  }
});
document.querySelectorAll(".name").forEach((element) => {
  if (
    element.parentElement.className.includes("details") ||
    element.parentElement.className.includes("info")
  ) {
    element.addEventListener("click", () => {
      let grandP = element.parentElement;
      goToProLink(grandP);
    });
  }
});
document.querySelectorAll(".view").forEach((element) => {
  element.addEventListener("click", () => {
    goToProLink(element);
  });
});
function goToProLink(element) {
  const productId = element.parentElement.getAttribute("data-id");

  const productDetailsUrl = `assets/shop/shop%20one%20item/shop%20one%20item.html?id=${productId}`;

  window.location.href = productDetailsUrl;
}
function performSearch() {
  const input = searchBar.value.toLowerCase();
  searchRes.innerHTML = "";

  if (input.trim() === "") {
    return;
  }

  // Filter results
  const results = Object.values(all_items).filter((item) =>
    item.name
      .toLowerCase()
      .split(" ")
      .some((word) => word.startsWith(input))
  );
  if (results.length > 0) {
    results.forEach((result) => {
      let res = document.createElement("div");
      res.style = "border-bottom: #5f5f5f 1px solid; padding: 10px 12px; ";
      res.classList.add(
        "result",
        "bg-[#1d1c1c]",
        "overflow-hidden",
        "h-[10vh]",
        "min-h-[70px]",
        "p-[6px]",
        "flex",
        "items-center",
        "justify-between",
        "cursor-pointer"
      );
      res.innerHTML = `
          <img
            class="h-full rounded-sm cursor-pointer"
            src="${result.img}"
            alt="" />
          <div class="info w-[101px]">
            <p
              class="mb-2  text-ellipsis whitespace-nowrap w-[101px] overflow-hidden text-[16px] transition-all duration-300 hover:text-sky-400 cursor-pointer text-[#cccccc]">
              ${result.name}
            </p>
            <span class="text-[16px] text-[#a8a8a8]" id="count">
              £<span id="price">${result.price.toFixed(2)}</span></span
            >
          </div>
        `;
      Object.values(all_items).forEach((item) => {
        if (item == result) {
          res.setAttribute(
            "data-id",
            Object.keys(all_items)[Object.values(all_items).indexOf(item)]
          );
        }
      });
      searchRes.appendChild(res);
      res.addEventListener("click", () => {
        const productId = res.getAttribute("data-id");

        const productDetailsUrl = `assets/shop/shop one item/shop one item.html?id=${productId}`;

        window.location.href = productDetailsUrl;
      });
    });
  } else {
    let res = document.createElement("div");
    res.style = "border-bottom: #5f5f5f 1px solid; padding: 10px 12px; ";
    res.classList.add(
      "result",
      "bg-[#1d1c1c]",
      "overflow-hidden",
      "h-[10vh]",
      "min-h-[50px]",
      "p-[6px]",
      "flex",
      "items-center",
      "justify-between",
      "text-[#cccccc]"
    );
    res.textContent = "No results found.";
    console.log("No results found.");

    searchRes.appendChild(res);
  }
}
searchBar.addEventListener("input", performSearch);
